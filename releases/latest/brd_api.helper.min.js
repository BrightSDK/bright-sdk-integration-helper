!function(){var n,t=!1,e=!1,o="bright_sdk.status",i=localStorage.getItem(o),s=function(){t&&console.log.apply(console,arguments)},u=function(){e&&console.error.apply(console,arguments)},c=[],r=!1,a=!1,l={init:function(n){return t=n.debug,e=n.debug||n.verbose,a=n.simple_opt_out,new Promise(function(t,e){l.getBrightApi(!1).then(function(o){s("init with settings: %o",n);var a=n.on_status_change,f=n.skip_consent;n.external_consent_options&&(l.createDialog(n),n.external_consent_options=void 0,n.skip_consent=!0,n.simple_opt_out=void 0),n.on_status_change=function(){try{var n=o.get_status(),t=n?n.value?n.value.consent:n.consent:null;l.onStatusChangeFn(t);for(var e=0;e<c.length;e++)c[e](t);c=[],a&&a(t)}catch(n){u(n)}};try{o.init(n,{on_failure:function(n){u("init failure. Error: ",n),e(new Error(n))},on_success:function(){s("init success"),r=!0,t(),f||i||l.showConsent(),l.showNotification(1e4)}})}catch(n){u(n),e()}})})},isInited:function(){return r},enable:function(n){return new Promise(function(t,e){return l.getBrightApi().then(function(o){if(!n)return l.onceStatusChange(t,"enableResolve",!0),l.showConsent().catch(e);o.external_opt_in({on_failure:function(n){u("external_opt_in failure",n),e()},on_success:function(){s("external_opt_in success"),t()}})})})},disable:function(){return i="disabled",new Promise(function(n,t){l.onceStatusChange(n,"disableResolve",!0),l.getBrightApi().then(function(n){n.opt_out({on_failure:function(n){u("opt_out failure",n),i="enabled",t()},on_success:function(){s("opt_out success")}})})})},showConsent:function(){if(n)return n.show(i);if(a){var t=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,keyCode:53,which:53,key:"5",code:"Digit5"});return document.dispatchEvent(t),Promise.resolve()}return new Promise(function(n,t){l.getBrightApi().then(function(e){e.show_consent({on_failure:function(n){u("show_consent failure: ",n),t(n)},on_success:function(){s("show_consent success"),n()}})})})},createDialog:function(t){if(window.ConsentModule){if(!n){var[e,o]=t.external_consent_options;o.language=t.lang,a&&(o.Out=!0);var i,s=o.onShow,c=o.onAccept,r=o.onDecline,f=o.onClose;o.onAccept=function(){l.enable(!0),c&&c()},o.onDecline=function(){l.disable(),r&&r()},o.onShow=function(){l.reportConsentShown(),s&&s()},o.onClose=function(){h(),f&&f()},n=ConsentModule.create(e,o),h()}}else u("ConsentModule not found, have you included it?");function h(){o.simpleOptOut&&(i=function(n){53==n.keyCode&&(n.preventDefault(),n.stopPropagation(),l.showConsent())},document.addEventListener("keydown",i,{capture:!0,once:!0}))}},onceStatusChange:function(n,t,e){e||(c=[]);var o=c.length;c.push(function(e){s("calling once hook %d: %s",o,t),n(e)})},onStatusChangeFn:function(n){s("BRD status changed ----- ",n),null!=n&&(i=n?"enabled":"disabled",localStorage.setItem(o,i))},getStatus:function(){return i},getStatusObject:function(){return l.getBrightApi().then(function(n){return n.get_status()})},isEnabled:function(){return"enabled"==i},showNotification:function(t){n&&n.showNotification(t)},reportConsentShown:function(){return l.getBrightApi().then(function(n){n.consent_shown()})},getBrightApi:function(n=!0,t=1e3){return Promise.resolve().then(function(){return n&&!r||!window.brd_api?(u("BRD API not available, retry in 1 sec..."),(e=t,new Promise(function(n){setTimeout(n,e)})).then(l.getBrightApi)):window.brd_api;var e})}};window.BrightSDK=l}();